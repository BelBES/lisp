% -*- coding: utf-8 -*-
% Представление окружений
\begin{tikzpicture}
  \tikzstyle{every node}=[font=\small]

  \draw (0.0em, 0.1em) node[anchor = south west] {\ii{записи активаций}};

  \draw [semithick] (0.0em,  0.00em) rectangle (4.0em, -3.75em);
  \draw             (0.0em, -1.25em) -- (4.0em, -1.25em);
  \draw [dashed]    (0.0em, -2.50em) -- (4.0em, -2.50em);

  \filldraw  (2.0em, -0.625em) circle(1.0pt);
  \draw [->] (2.0em, -0.625em) -- (7.25em, -0.625em);

  \draw [semithick] (7.5em,  0.00em) rectangle (11.5em, -5.00em);
  \draw             (7.5em, -1.25em) -- (11.5em, -1.25em);
  \draw [dashed]    (7.5em, -2.50em) -- (11.5em, -2.50em);
  \draw [dashed]    (7.5em, -3.75em) -- (11.5em, -3.75em);

  \filldraw  (9.5em, -0.625em) circle(1.0pt);
  \draw [->] (9.5em, -0.625em) -- (13.50em, -0.625em);

  \draw (13.3em, -0.55em) node[right] {\ii{nil}};



  \draw (20.50em, 0.1em) node[above] {\ii{глобальное окружение}};

  \draw [semithick] (19.5em,  0.0em) rectangle (23.5em, -10.0em);
  \draw             (19.5em, -4.0em)  -- (23.5em, -4.0em);
  \draw             (19.5em, -5.25em) -- (23.5em, -5.25em);

  \draw (21.5em, -3.625em) node[above] {$\vdots$};
  \draw (21.5em, -5.125em) node[below] {$\vdots$};

  \draw (23.5em, -4.625em) node[right] {\footnotesize\ic{23}};
  \draw (23.5em, 0.0em) node[anchor = north west] {\footnotesize\ic{0}};



  \draw (-6.5em, 0.1em) node[above, text width = 4.5em, align = left]
          {\ii{реифицированное окружение}};

  \draw [semithick] (-8.0em, 0.0em) rectangle (-5.0em, -2.5em);
  \draw             (-8.0em, -1.25em) -- (-5.0em, -1.25em);

  \filldraw  (-6.5em, -0.625em) circle(1.0pt);
  \draw [->] (-6.5em, -0.625em) -- (-0.25em, -0.625em);

  \filldraw  (-6.5em, -1.875em) circle(1.0pt);
  \draw [->] (-6.5em, -1.875em) -- (-6.5em, -6.5em);

  \draw (-8.5em, -6.0em) node[rectangle, anchor = north west] {%
\begin{code:lisp}
( (foo (local 0 0))
  (bar (local 1 2))
  (hux (global 23))
  ... )
\end{code:lisp}};

  \draw [dashed, ->] (-3.0em, -6.75em) --
                     (-3.0em, -1.875em) -- (-0.25em, -1.875em);
  
  \draw [dashed, ->] (1.25em, -8.375em) -- (5.25em, -8.375em) --
                     (5.25em, -4.375em) -- (7.25em, -4.375em);
  
  \draw [dashed, ->] (1.25em, -9.5em) -- (15.50em, -9.5em) --
                     (15.50em, -4.625em) -- (19.25em, -4.625em);

\end{tikzpicture}
