% -*- coding: utf-8 -*-
% Цепочка вычислителей
\begin{tikzpicture}
  \tikzstyle{every node}=[font=\small]

\def\EvaluatorLevel#1{%
  \node [anchor = south] at(0.0em, +1.5em) {\emph{Уровень #1}};
  \node [anchor = mid]   at(0.0em,  0.0em) {\ic{expand}};
  \draw [->]      (0.0em, -0.35em) -- (0.0em, -1.90em);
  \node [anchor = north] at(0.0em, -1.5em) {\ic{eval}};
}

\begin{scope}[xshift = 0em]
  \draw [->] (-3.0em, 3.500em) -- (-3.0em, 1.125em) --
             ( 0.0em, 1.125em) -- ( 0.0em, 0.350em);
  \EvaluatorLevel{0}
  \draw [->] (-0.75em, -0.350em) -- (-0.75em, -1.000em) --
             (-3.00em, -1.000em) -- (-3.00em, -3.37em);
  \node [anchor = north] at (-3.0em, -3.37em) {\ic{compile}};
\begin{scope}[xshift = 10em]
  \draw [->] (-8.25em, +0.3em) -- (-3.00em, 1.125em) --
             ( 0.0em, 1.125em) -- ( 0.0em,  0.350em);
  \EvaluatorLevel{1}
  \draw [->] ( 0.0em,  -2.600em) -- ( 0.00em, -3.125em) --
             (-3.00em, -3.125em) -- (-8.25em, -0.300em);
\begin{scope}[xshift = 10em]
  \draw [->] (-8.25em, +0.3em) -- (-3.00em, 1.125em) --
             ( 0.0em, 1.125em) -- ( 0.0em,  0.350em);
  \EvaluatorLevel{2}
  \draw [->] ( 0.0em,  -2.600em) -- ( 0.00em, -3.125em) --
             (-3.00em, -3.125em) -- (-8.25em, -0.300em);
\end{scope}\end{scope}\end{scope}

\end{tikzpicture}
